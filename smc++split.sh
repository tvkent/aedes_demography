#!/bin/bash
#SBATCH -D /work/users/t/v/tvkent/aedes/
#SBATCH --time=20:00:00
#SBATCH --mem=80G
#SBATCH --cpus-per-task=4
#SBATCH --array=0-4
#SBATCH -J gabonUSA
#SBATCH -o /work/users/t/v/tvkent/aedes/logs/smc++gabonUSA-out-%A.%a.txt
#SBATCH -e /work/users/t/v/tvkent/aedes/logs/smc++gabonUSA-error-%A.%a.txt
#0-34
set -e
set -u

workdir=/work/users/t/v/tvkent/aedes

#pop_pairs=("Rio_Claro-Cali" "Rio_Claro-Brazil" "Rio_Claro-Senegal" "Rio_Claro-USA" "Rio_Claro-Kenya" "Rio_Claro-Gabon" "Cali-Brazil" "Cali-USA" "Cali-Senegal" "Cali-Kenya" "Cali-Gabon" "Brazil-USA" "Brazil-Kenya" "Brazil-Senegal" "Brazil-Gabon" "Kenya-Senegal" "Kenya-Gabon" "Kenya-USA" "Senegal-Gabon" "Senegal-USA" "Gabon-USA")
#pop_pairs=("NorCal-SoCal" "NorCal-Florida" "NorCal-Exeter" "NorCal-Clovis" "SoCal-Florida" "SoCal-Exeter" "SoCal-Clovis" "Florida-Exeter" "Florida-Clovis" "Clovis-Exeter")
#pop_pairs=("Rio_Claro-Cali" "Rio_Claro-Brazil" "Rio_Claro-Senegal" "Rio_Claro-USA" "Rio_Claro-Kenya" "Rio_Claro-Gabon" "Cali-Brazil" "Cali-USA" "Cali-Senegal" "Cali-Kenya" "Cali-Gabon" "Brazil-USA" "Brazil-Kenya" "Brazil-Senegal" "Brazil-Gabon" "Kenya-Senegal" "Kenya-Gabon" "Kenya-USA" "Senegal-Gabon" "Senegal-USA" "Gabon-USA" "NorCal-SoCal" "NorCal-Florida" "NorCal-Exeter" "NorCal-Clovis" "SoCal-Florida" "SoCal-Exeter" "SoCal-Clovis" "Florida-Exeter" "Florida-Clovis" "Clovis-Exeter")
pop_pairs=("Gabon-USA")
#chrs=("AaegL5_1" "AaegL5_2" "AaegL5_3")

popid=$((SLURM_ARRAY_TASK_ID / 5))
distind=$((SLURM_ARRAY_TASK_ID % 5))
#bootid=$(((SLURM_ARRAY_TASK_ID % 20) +1))
pop=${pop_pairs[popid]}
#pop=${pop_pairs[SLURM_ARRAY_TASK_ID]}
#echo $pop
#echo $distind
# randomly chosen 5 individuals to be distinguished for each pop
if [[ "$pop" == "Rio_Claro-Cali" ]]; then
	#echo 'yes'
	pop1="Rio_Claro"
	pop2="Cali"
	distinguished1=("FEMALE_3-F3_ATCCGGTA-TATCGGTC_S16" "MALE_5-M5_CATGGCTA-GATGTGTG_S27" "MALE_2-M2_TAACCGGT-GAGACGAT_S24" "FEMALE_10-F10_GTGCCATA-ACTAGGAG_S2" "FEMALE_14-F14_ACGTTCAG-GCACAACT_S6")
	indivs1=("RC:FEMALE_1-F1_CGCATGAT-TCAGGCTT_S1,FEMALE_10-F10_GTGCCATA-ACTAGGAG_S2,FEMALE_11-F11_CGTTGCAA-CGCTCTAT_S3,FEMALE_12-F12_TGAAGACG-TGGCATGT_S4,FEMALE_14-F14_ACGTTCAG-GCACAACT_S6,FEMALE_15-F15_ATGCACGA-GACGATCT_S7,FEMALE_17-F17_CGGCTAAT-AGAACGAG_S9,FEMALE_18-F18_GAATCCGA-CACTAGCT_S10,FEMALE_2-F2_CTTAGGAC-GTAGGAGT_S12,FEMALE_20-F20_GTTACGCA-ATCGCCAT_S13,FEMALE_21-F21_ATGACGTC-GAAGGAAG_S14,FEMALE_22-F22_CAGTCCAA-GATTACCG_S15,FEMALE_3-F3_ATCCGGTA-TATCGGTC_S16,FEMALE_5-F5_CATACCAC-CGGTTGTT_S18,FEMALE_6-F6_AACGTCTG-GCGTCATT_S19,FEMALE_7-F7_CCTGATTG-AACTGAGC_S20,FEMALE_8-F8_CCTTGTAG-TTCCAAGG_S21,FEMALE_9-F9_ACGGAACA-GTTCTCGT_S22,MALE_1-M1_CGACGTTA-ATCCAGAG_S23,MALE_2-M2_TAACCGGT-GAGACGAT_S24,MALE_3-M3_ATCGATCG-TGCTTCCA_S25,MALE_4-M4_TCGCTGTT-ACGACTTG_S26,MALE_5-M5_CATGGCTA-GATGTGTG_S27,MALE_6-M6_AGCGTGTT-TTGCGAAG_S28")
	distinguished2=("JB_A2_25_S3" "JB_A2_50_S10" "JB_A2_34_S5" "JB_A2_36_S7" "JB_A2_19_S2")
	indivs2=("Cali:JB_A2_18_S1,JB_A2_19_S2,JB_A2_25_S3,JB_A2_29_S4,JB_A2_34_S5,JB_A2_35_S6,JB_A2_36_S7,JB_A2_39_S8,JB_A2_46_S9,JB_A2_50_S10")

elif [[ "$pop" == "Rio_Claro-Brazil" ]]; then
	pop1="Rio_Claro"
	pop2="Brazil"
	distinguished1=("FEMALE_3-F3_ATCCGGTA-TATCGGTC_S16" "MALE_5-M5_CATGGCTA-GATGTGTG_S27" "MALE_2-M2_TAACCGGT-GAGACGAT_S24" "FEMALE_10-F10_GTGCCATA-ACTAGGAG_S2" "FEMALE_14-F14_ACGTTCAG-GCACAACT_S6")
	indivs1=("RC:FEMALE_1-F1_CGCATGAT-TCAGGCTT_S1,FEMALE_10-F10_GTGCCATA-ACTAGGAG_S2,FEMALE_11-F11_CGTTGCAA-CGCTCTAT_S3,FEMALE_12-F12_TGAAGACG-TGGCATGT_S4,FEMALE_14-F14_ACGTTCAG-GCACAACT_S6,FEMALE_15-F15_ATGCACGA-GACGATCT_S7,FEMALE_17-F17_CGGCTAAT-AGAACGAG_S9,FEMALE_18-F18_GAATCCGA-CACTAGCT_S10,FEMALE_2-F2_CTTAGGAC-GTAGGAGT_S12,FEMALE_20-F20_GTTACGCA-ATCGCCAT_S13,FEMALE_21-F21_ATGACGTC-GAAGGAAG_S14,FEMALE_22-F22_CAGTCCAA-GATTACCG_S15,FEMALE_3-F3_ATCCGGTA-TATCGGTC_S16,FEMALE_5-F5_CATACCAC-CGGTTGTT_S18,FEMALE_6-F6_AACGTCTG-GCGTCATT_S19,FEMALE_7-F7_CCTGATTG-AACTGAGC_S20,FEMALE_8-F8_CCTTGTAG-TTCCAAGG_S21,FEMALE_9-F9_ACGGAACA-GTTCTCGT_S22,MALE_1-M1_CGACGTTA-ATCCAGAG_S23,MALE_2-M2_TAACCGGT-GAGACGAT_S24,MALE_3-M3_ATCGATCG-TGCTTCCA_S25,MALE_4-M4_TCGCTGTT-ACGACTTG_S26,MALE_5-M5_CATGGCTA-GATGTGTG_S27,MALE_6-M6_AGCGTGTT-TTGCGAAG_S28")
	distinguished2=("SRR11006838" "SRR11006841" "SRR11006846" "SRR11006842" "SRR11006852")
	indivs2=("Brazil:SRR11006835,SRR11006836,SRR11006837,SRR11006838,SRR11006839,SRR11006840,SRR11006841,SRR11006842,SRR11006843,SRR11006846,SRR11006847,SRR11006848,SRR11006849,SRR11006850,SRR11006851,SRR11006852,SRR11006853,SRR11006854")

elif [[ "$pop" == "Rio_Claro-Senegal" ]]; then
	pop1="Rio_Claro"
	pop2="Senegal"
	distinguished1=("FEMALE_3-F3_ATCCGGTA-TATCGGTC_S16" "MALE_5-M5_CATGGCTA-GATGTGTG_S27" "MALE_2-M2_TAACCGGT-GAGACGAT_S24" "FEMALE_10-F10_GTGCCATA-ACTAGGAG_S2" "FEMALE_14-F14_ACGTTCAG-GCACAACT_S6")
	indivs1=("RC:FEMALE_1-F1_CGCATGAT-TCAGGCTT_S1,FEMALE_10-F10_GTGCCATA-ACTAGGAG_S2,FEMALE_11-F11_CGTTGCAA-CGCTCTAT_S3,FEMALE_12-F12_TGAAGACG-TGGCATGT_S4,FEMALE_14-F14_ACGTTCAG-GCACAACT_S6,FEMALE_15-F15_ATGCACGA-GACGATCT_S7,FEMALE_17-F17_CGGCTAAT-AGAACGAG_S9,FEMALE_18-F18_GAATCCGA-CACTAGCT_S10,FEMALE_2-F2_CTTAGGAC-GTAGGAGT_S12,FEMALE_20-F20_GTTACGCA-ATCGCCAT_S13,FEMALE_21-F21_ATGACGTC-GAAGGAAG_S14,FEMALE_22-F22_CAGTCCAA-GATTACCG_S15,FEMALE_3-F3_ATCCGGTA-TATCGGTC_S16,FEMALE_5-F5_CATACCAC-CGGTTGTT_S18,FEMALE_6-F6_AACGTCTG-GCGTCATT_S19,FEMALE_7-F7_CCTGATTG-AACTGAGC_S20,FEMALE_8-F8_CCTTGTAG-TTCCAAGG_S21,FEMALE_9-F9_ACGGAACA-GTTCTCGT_S22,MALE_1-M1_CGACGTTA-ATCCAGAG_S23,MALE_2-M2_TAACCGGT-GAGACGAT_S24,MALE_3-M3_ATCGATCG-TGCTTCCA_S25,MALE_4-M4_TCGCTGTT-ACGACTTG_S26,MALE_5-M5_CATGGCTA-GATGTGTG_S27,MALE_6-M6_AGCGTGTT-TTGCGAAG_S28")
	distinguished2=("SRR11006755" "SRR11006770" "SRR11006763" "SRR11006753" "SRR11006766")
	indivs2=("Senegal:SRR11006749,SRR11006751,SRR11006752,SRR11006753,SRR11006754,SRR11006755,SRR11006756,SRR11006757,SRR11006758,SRR11006759,SRR11006760,SRR11006762,SRR11006763,SRR11006764,SRR11006765,SRR11006766,SRR11006767,SRR11006768,SRR11006769,SRR11006770")

elif [[ "$pop" == "Rio_Claro-Kenya" ]]; then
	pop1="Rio_Claro"
	pop2="Kenya"
	distinguished1=("FEMALE_3-F3_ATCCGGTA-TATCGGTC_S16" "MALE_5-M5_CATGGCTA-GATGTGTG_S27" "MALE_2-M2_TAACCGGT-GAGACGAT_S24" "FEMALE_10-F10_GTGCCATA-ACTAGGAG_S2" "FEMALE_14-F14_ACGTTCAG-GCACAACT_S6")
	indivs1=("RC:FEMALE_1-F1_CGCATGAT-TCAGGCTT_S1,FEMALE_10-F10_GTGCCATA-ACTAGGAG_S2,FEMALE_11-F11_CGTTGCAA-CGCTCTAT_S3,FEMALE_12-F12_TGAAGACG-TGGCATGT_S4,FEMALE_14-F14_ACGTTCAG-GCACAACT_S6,FEMALE_15-F15_ATGCACGA-GACGATCT_S7,FEMALE_17-F17_CGGCTAAT-AGAACGAG_S9,FEMALE_18-F18_GAATCCGA-CACTAGCT_S10,FEMALE_2-F2_CTTAGGAC-GTAGGAGT_S12,FEMALE_20-F20_GTTACGCA-ATCGCCAT_S13,FEMALE_21-F21_ATGACGTC-GAAGGAAG_S14,FEMALE_22-F22_CAGTCCAA-GATTACCG_S15,FEMALE_3-F3_ATCCGGTA-TATCGGTC_S16,FEMALE_5-F5_CATACCAC-CGGTTGTT_S18,FEMALE_6-F6_AACGTCTG-GCGTCATT_S19,FEMALE_7-F7_CCTGATTG-AACTGAGC_S20,FEMALE_8-F8_CCTTGTAG-TTCCAAGG_S21,FEMALE_9-F9_ACGGAACA-GTTCTCGT_S22,MALE_1-M1_CGACGTTA-ATCCAGAG_S23,MALE_2-M2_TAACCGGT-GAGACGAT_S24,MALE_3-M3_ATCGATCG-TGCTTCCA_S25,MALE_4-M4_TCGCTGTT-ACGACTTG_S26,MALE_5-M5_CATGGCTA-GATGTGTG_S27,MALE_6-M6_AGCGTGTT-TTGCGAAG_S28")
	distinguished2=("SRR11006669" "SRR11006683" "SRR11006672" "SRR11006674" "SRR11006675")
	indivs2=("Kenya:SRR11006665,SRR11006666,SRR11006667,SRR11006668,SRR11006669,SRR11006670,SRR11006672,SRR11006673,SRR11006674,SRR11006675,SRR11006676,SRR11006677,SRR11006678,SRR11006679,SRR11006680,SRR11006681,SRR11006683,SRR11006684,SRR11006685")

elif [[ "$pop" == "Rio_Claro-Gabon" ]]; then
	pop1="Rio_Claro"
	pop2="Gabon"
	distinguished1=("FEMALE_3-F3_ATCCGGTA-TATCGGTC_S16" "MALE_5-M5_CATGGCTA-GATGTGTG_S27" "MALE_2-M2_TAACCGGT-GAGACGAT_S24" "FEMALE_10-F10_GTGCCATA-ACTAGGAG_S2" "FEMALE_14-F14_ACGTTCAG-GCACAACT_S6")
	indivs1=("RC:FEMALE_1-F1_CGCATGAT-TCAGGCTT_S1,FEMALE_10-F10_GTGCCATA-ACTAGGAG_S2,FEMALE_11-F11_CGTTGCAA-CGCTCTAT_S3,FEMALE_12-F12_TGAAGACG-TGGCATGT_S4,FEMALE_14-F14_ACGTTCAG-GCACAACT_S6,FEMALE_15-F15_ATGCACGA-GACGATCT_S7,FEMALE_17-F17_CGGCTAAT-AGAACGAG_S9,FEMALE_18-F18_GAATCCGA-CACTAGCT_S10,FEMALE_2-F2_CTTAGGAC-GTAGGAGT_S12,FEMALE_20-F20_GTTACGCA-ATCGCCAT_S13,FEMALE_21-F21_ATGACGTC-GAAGGAAG_S14,FEMALE_22-F22_CAGTCCAA-GATTACCG_S15,FEMALE_3-F3_ATCCGGTA-TATCGGTC_S16,FEMALE_5-F5_CATACCAC-CGGTTGTT_S18,FEMALE_6-F6_AACGTCTG-GCGTCATT_S19,FEMALE_7-F7_CCTGATTG-AACTGAGC_S20,FEMALE_8-F8_CCTTGTAG-TTCCAAGG_S21,FEMALE_9-F9_ACGGAACA-GTTCTCGT_S22,MALE_1-M1_CGACGTTA-ATCCAGAG_S23,MALE_2-M2_TAACCGGT-GAGACGAT_S24,MALE_3-M3_ATCGATCG-TGCTTCCA_S25,MALE_4-M4_TCGCTGTT-ACGACTTG_S26,MALE_5-M5_CATGGCTA-GATGTGTG_S27,MALE_6-M6_AGCGTGTT-TTGCGAAG_S28")
	distinguished2=("SRR11006829" "SRR11006831" "SRR11006828" "SRR11006823" "SRR11006834")
	indivs2=("Gabon:SRR11006820,SRR11006821,SRR11006823,SRR11006824,SRR11006825,SRR11006826,SRR11006827,SRR11006828,SRR11006829,SRR11006830,SRR11006831,SRR11006832,SRR11006834")

elif [[ "$pop" == "Rio_Claro-USA" ]]; then
	pop1="Rio_Claro"
	pop2="USA"
	distinguished1=("FEMALE_3-F3_ATCCGGTA-TATCGGTC_S16" "MALE_5-M5_CATGGCTA-GATGTGTG_S27" "MALE_2-M2_TAACCGGT-GAGACGAT_S24" "FEMALE_10-F10_GTGCCATA-ACTAGGAG_S2" "FEMALE_14-F14_ACGTTCAG-GCACAACT_S6")
	indivs1=("RC:FEMALE_1-F1_CGCATGAT-TCAGGCTT_S1,FEMALE_10-F10_GTGCCATA-ACTAGGAG_S2,FEMALE_11-F11_CGTTGCAA-CGCTCTAT_S3,FEMALE_12-F12_TGAAGACG-TGGCATGT_S4,FEMALE_14-F14_ACGTTCAG-GCACAACT_S6,FEMALE_15-F15_ATGCACGA-GACGATCT_S7,FEMALE_17-F17_CGGCTAAT-AGAACGAG_S9,FEMALE_18-F18_GAATCCGA-CACTAGCT_S10,FEMALE_2-F2_CTTAGGAC-GTAGGAGT_S12,FEMALE_20-F20_GTTACGCA-ATCGCCAT_S13,FEMALE_21-F21_ATGACGTC-GAAGGAAG_S14,FEMALE_22-F22_CAGTCCAA-GATTACCG_S15,FEMALE_3-F3_ATCCGGTA-TATCGGTC_S16,FEMALE_5-F5_CATACCAC-CGGTTGTT_S18,FEMALE_6-F6_AACGTCTG-GCGTCATT_S19,FEMALE_7-F7_CCTGATTG-AACTGAGC_S20,FEMALE_8-F8_CCTTGTAG-TTCCAAGG_S21,FEMALE_9-F9_ACGGAACA-GTTCTCGT_S22,MALE_1-M1_CGACGTTA-ATCCAGAG_S23,MALE_2-M2_TAACCGGT-GAGACGAT_S24,MALE_3-M3_ATCGATCG-TGCTTCCA_S25,MALE_4-M4_TCGCTGTT-ACGACTTG_S26,MALE_5-M5_CATGGCTA-GATGTGTG_S27,MALE_6-M6_AGCGTGTT-TTGCGAAG_S28")
	distinguished2=("SRR6768021" "SRR6768024" "SRR6768014" "SRR6768012" "SRR6768003")
	indivs2=("USA:SRR6768001,SRR6768002,SRR6768003,SRR6768004,SRR6768006,SRR6768007,SRR6768008,SRR6768009,SRR6768010,SRR6768011,SRR6768012,SRR6768013,SRR6768014,SRR6768015,SRR6768016,SRR6768017,SRR6768018,SRR6768019,SRR6768020,SRR6768021,SRR6768022,SRR6768023,SRR6768024,SRR6768025,SRR6768026,SRR6768027,SRR6768028")

elif [[ "$pop" == "Cali-Brazil" ]]; then
	pop1="Cali"
	pop2="Brazil"
	distinguished1=("JB_A2_25_S3" "JB_A2_50_S10" "JB_A2_34_S5" "JB_A2_36_S7" "JB_A2_19_S2")
	indivs1=("Cali:JB_A2_18_S1,JB_A2_19_S2,JB_A2_25_S3,JB_A2_29_S4,JB_A2_34_S5,JB_A2_35_S6,JB_A2_36_S7,JB_A2_39_S8,JB_A2_46_S9,JB_A2_50_S10")
	distinguished2=("SRR11006838" "SRR11006841" "SRR11006846" "SRR11006842" "SRR11006852")
	indivs2=("Brazil:SRR11006835,SRR11006836,SRR11006837,SRR11006838,SRR11006839,SRR11006840,SRR11006841,SRR11006842,SRR11006843,SRR11006846,SRR11006847,SRR11006848,SRR11006849,SRR11006850,SRR11006851,SRR11006852,SRR11006853,SRR11006854")

elif [[ "$pop" == "Cali-USA" ]]; then
	pop1="Cali"
	pop2="USA"
	distinguished1=("JB_A2_25_S3" "JB_A2_50_S10" "JB_A2_34_S5" "JB_A2_36_S7" "JB_A2_19_S2")
	indivs1=("Cali:JB_A2_18_S1,JB_A2_19_S2,JB_A2_25_S3,JB_A2_29_S4,JB_A2_34_S5,JB_A2_35_S6,JB_A2_36_S7,JB_A2_39_S8,JB_A2_46_S9,JB_A2_50_S10")
	distinguished2=("SRR6768021" "SRR6768024" "SRR6768014" "SRR6768012" "SRR6768003")
	indivs2=("USA:SRR6768001,SRR6768002,SRR6768003,SRR6768004,SRR6768006,SRR6768007,SRR6768008,SRR6768009,SRR6768010,SRR6768011,SRR6768012,SRR6768013,SRR6768014,SRR6768015,SRR6768016,SRR6768017,SRR6768018,SRR6768019,SRR6768020,SRR6768021,SRR6768022,SRR6768023,SRR6768024,SRR6768025,SRR6768026,SRR6768027,SRR6768028")

elif [[ "$pop" == "Cali-Senegal" ]]; then
	pop1="Cali"
	pop2="Senegal"
        distinguished1=("JB_A2_25_S3" "JB_A2_50_S10" "JB_A2_34_S5" "JB_A2_36_S7" "JB_A2_19_S2")
        indivs1=("Cali:JB_A2_18_S1,JB_A2_19_S2,JB_A2_25_S3,JB_A2_29_S4,JB_A2_34_S5,JB_A2_35_S6,JB_A2_36_S7,JB_A2_39_S8,JB_A2_46_S9,JB_A2_50_S10")
	distinguished2=("SRR11006755" "SRR11006770" "SRR11006763" "SRR11006753" "SRR11006766")
	indivs2=("Senegal:SRR11006749,SRR11006751,SRR11006752,SRR11006753,SRR11006754,SRR11006755,SRR11006756,SRR11006757,SRR11006758,SRR11006759,SRR11006760,SRR11006762,SRR11006763,SRR11006764,SRR11006765,SRR11006766,SRR11006767,SRR11006768,SRR11006769,SRR11006770")

elif [[ "$pop" == "Cali-Kenya" ]]; then
	pop1="Cali"
	pop2="Kenya"
	distinguished1=("JB_A2_25_S3" "JB_A2_50_S10" "JB_A2_34_S5" "JB_A2_36_S7" "JB_A2_19_S2")
	indivs1=("Cali:JB_A2_18_S1,JB_A2_19_S2,JB_A2_25_S3,JB_A2_29_S4,JB_A2_34_S5,JB_A2_35_S6,JB_A2_36_S7,JB_A2_39_S8,JB_A2_46_S9,JB_A2_50_S10")
	distinguished2=("SRR11006669" "SRR11006683" "SRR11006672" "SRR11006674" "SRR11006675")
	indivs2=("Kenya:SRR11006665,SRR11006666,SRR11006667,SRR11006668,SRR11006669,SRR11006670,SRR11006672,SRR11006673,SRR11006674,SRR11006675,SRR11006676,SRR11006677,SRR11006678,SRR11006679,SRR11006680,SRR11006681,SRR11006683,SRR11006684,SRR11006685")

elif [[ "$pop" == "Cali-Gabon" ]]; then
	pop1="Cali"
	pop2="Gabon"
	distinguished1=("JB_A2_25_S3" "JB_A2_50_S10" "JB_A2_34_S5" "JB_A2_36_S7" "JB_A2_19_S2")
	indivs1=("Cali:JB_A2_18_S1,JB_A2_19_S2,JB_A2_25_S3,JB_A2_29_S4,JB_A2_34_S5,JB_A2_35_S6,JB_A2_36_S7,JB_A2_39_S8,JB_A2_46_S9,JB_A2_50_S10")
	distinguished2=("SRR11006829" "SRR11006831" "SRR11006828" "SRR11006823" "SRR11006834")
	indivs2=("Gabon:SRR11006820,SRR11006821,SRR11006823,SRR11006824,SRR11006825,SRR11006826,SRR11006827,SRR11006828,SRR11006829,SRR11006830,SRR11006831,SRR11006832,SRR11006834")

elif [[ "$pop" == "Brazil-USA" ]]; then
	pop1="Brazil"
	pop2="USA"
	distinguished1=("SRR11006838" "SRR11006841" "SRR11006846" "SRR11006842" "SRR11006852")
	indivs1=("Brazil:SRR11006835,SRR11006836,SRR11006837,SRR11006838,SRR11006839,SRR11006840,SRR11006841,SRR11006842,SRR11006843,SRR11006846,SRR11006847,SRR11006848,SRR11006849,SRR11006850,SRR11006851,SRR11006852,SRR11006853,SRR11006854")
	distinguished2=("SRR6768021" "SRR6768024" "SRR6768014" "SRR6768012" "SRR6768003")
	indivs2=("USA:SRR6768001,SRR6768002,SRR6768003,SRR6768004,SRR6768006,SRR6768007,SRR6768008,SRR6768009,SRR6768010,SRR6768011,SRR6768012,SRR6768013,SRR6768014,SRR6768015,SRR6768016,SRR6768017,SRR6768018,SRR6768019,SRR6768020,SRR6768021,SRR6768022,SRR6768023,SRR6768024,SRR6768025,SRR6768026,SRR6768027,SRR6768028")

elif [[ "$pop" == "Brazil-Senegal" ]]; then
	pop1="Brazil"
	pop2="Senegal"
	distinguished1=("SRR11006838" "SRR11006841" "SRR11006846" "SRR11006842" "SRR11006852")
	indivs1=("Brazil:SRR11006835,SRR11006836,SRR11006837,SRR11006838,SRR11006839,SRR11006840,SRR11006841,SRR11006842,SRR11006843,SRR11006846,SRR11006847,SRR11006848,SRR11006849,SRR11006850,SRR11006851,SRR11006852,SRR11006853,SRR11006854")
	distinguished2=("SRR11006755" "SRR11006770" "SRR11006763" "SRR11006753" "SRR11006766")
	indivs2=("Senegal:SRR11006749,SRR11006751,SRR11006752,SRR11006753,SRR11006754,SRR11006755,SRR11006756,SRR11006757,SRR11006758,SRR11006759,SRR11006760,SRR11006762,SRR11006763,SRR11006764,SRR11006765,SRR11006766,SRR11006767,SRR11006768,SRR11006769,SRR11006770")

elif [[ "$pop" == "Brazil-Kenya" ]]; then
	pop1="Brazil"
	pop2="Kenya"
	distinguished1=("SRR11006838" "SRR11006841" "SRR11006846" "SRR11006842" "SRR11006852")
	indivs1=("Brazil:SRR11006835,SRR11006836,SRR11006837,SRR11006838,SRR11006839,SRR11006840,SRR11006841,SRR11006842,SRR11006843,SRR11006846,SRR11006847,SRR11006848,SRR11006849,SRR11006850,SRR11006851,SRR11006852,SRR11006853,SRR11006854")
	distinguished2=("SRR11006669" "SRR11006683" "SRR11006672" "SRR11006674" "SRR11006675")
	indivs2=("Kenya:SRR11006665,SRR11006666,SRR11006667,SRR11006668,SRR11006669,SRR11006670,SRR11006672,SRR11006673,SRR11006674,SRR11006675,SRR11006676,SRR11006677,SRR11006678,SRR11006679,SRR11006680,SRR11006681,SRR11006683,SRR11006684,SRR11006685")

elif [[ "$pop" == "Brazil-Gabon" ]]; then
	pop1="Brazil"
	pop2="Gabon"
	distinguished1=("SRR11006838" "SRR11006841" "SRR11006846" "SRR11006842" "SRR11006852")
	indivs1=("Brazil:SRR11006835,SRR11006836,SRR11006837,SRR11006838,SRR11006839,SRR11006840,SRR11006841,SRR11006842,SRR11006843,SRR11006846,SRR11006847,SRR11006848,SRR11006849,SRR11006850,SRR11006851,SRR11006852,SRR11006853,SRR11006854")
	distinguished2=("SRR11006829" "SRR11006831" "SRR11006828" "SRR11006823" "SRR11006834")
	indivs2=("Gabon:SRR11006820,SRR11006821,SRR11006823,SRR11006824,SRR11006825,SRR11006826,SRR11006827,SRR11006828,SRR11006829,SRR11006830,SRR11006831,SRR11006832,SRR11006834")

elif [[ "$pop" == "Kenya-USA" ]]; then
	pop1="Kenya"
	pop2="USA"
	distinguished1=("SRR11006669" "SRR11006683" "SRR11006672" "SRR11006674" "SRR11006675")
	indivs1=("Kenya:SRR11006665,SRR11006666,SRR11006667,SRR11006668,SRR11006669,SRR11006670,SRR11006672,SRR11006673,SRR11006674,SRR11006675,SRR11006676,SRR11006677,SRR11006678,SRR11006679,SRR11006680,SRR11006681,SRR11006683,SRR11006684,SRR11006685")
        distinguished2=("SRR6768021" "SRR6768024" "SRR6768014" "SRR6768012" "SRR6768003")
        indivs2=("USA:SRR6768001,SRR6768002,SRR6768003,SRR6768004,SRR6768006,SRR6768007,SRR6768008,SRR6768009,SRR6768010,SRR6768011,SRR6768012,SRR6768013,SRR6768014,SRR6768015,SRR6768016,SRR6768017,SRR6768018,SRR6768019,SRR6768020,SRR6768021,SRR6768022,SRR6768023,SRR6768024,SRR6768025,SRR6768026,SRR6768027,SRR6768028")

elif [[ "$pop" == "Kenya-Senegal" ]]; then
	pop1="Kenya"
	pop2="Senegal"
	distinguished1=("SRR11006669" "SRR11006683" "SRR11006672" "SRR11006674" "SRR11006675")
	indivs1=("Kenya:SRR11006665,SRR11006666,SRR11006667,SRR11006668,SRR11006669,SRR11006670,SRR11006672,SRR11006673,SRR11006674,SRR11006675,SRR11006676,SRR11006677,SRR11006678,SRR11006679,SRR11006680,SRR11006681,SRR11006683,SRR11006684,SRR11006685")
        distinguished2=("SRR11006755" "SRR11006770" "SRR11006763" "SRR11006753" "SRR11006766")
        indivs2=("Senegal:SRR11006749,SRR11006751,SRR11006752,SRR11006753,SRR11006754,SRR11006755,SRR11006756,SRR11006757,SRR11006758,SRR11006759,SRR11006760,SRR11006762,SRR11006763,SRR11006764,SRR11006765,SRR11006766,SRR11006767,SRR11006768,SRR11006769,SRR11006770")

elif [[ "$pop" == "Kenya-Gabon" ]]; then
	pop1="Kenya"
	pop2="Gabon"
	distinguished1=("SRR11006669" "SRR11006683" "SRR11006672" "SRR11006674" "SRR11006675")
	indivs1=("Kenya:SRR11006665,SRR11006666,SRR11006667,SRR11006668,SRR11006669,SRR11006670,SRR11006672,SRR11006673,SRR11006674,SRR11006675,SRR11006676,SRR11006677,SRR11006678,SRR11006679,SRR11006680,SRR11006681,SRR11006683,SRR11006684,SRR11006685")
        distinguished2=("SRR11006829" "SRR11006831" "SRR11006828" "SRR11006823" "SRR11006834")
        indivs2=("Gabon:SRR11006820,SRR11006821,SRR11006823,SRR11006824,SRR11006825,SRR11006826,SRR11006827,SRR11006828,SRR11006829,SRR11006830,SRR11006831,SRR11006832,SRR11006834")

elif [[ "$pop" == "Senegal-Gabon" ]]; then
	pop1="Senegal"
	pop2="Gabon"
        distinguished1=("SRR11006755" "SRR11006770" "SRR11006763" "SRR11006753" "SRR11006766")
	indivs1=("Senegal:SRR11006749,SRR11006751,SRR11006752,SRR11006753,SRR11006754,SRR11006755,SRR11006756,SRR11006757,SRR11006758,SRR11006759,SRR11006760,SRR11006762,SRR11006763,SRR11006764,SRR11006765,SRR11006766,SRR11006767,SRR11006768,SRR11006769,SRR11006770")
	distinguished2=("SRR11006829" "SRR11006831" "SRR11006828" "SRR11006823" "SRR11006834")
        indivs2=("Gabon:SRR11006820,SRR11006821,SRR11006823,SRR11006824,SRR11006825,SRR11006826,SRR11006827,SRR11006828,SRR11006829,SRR11006830,SRR11006831,SRR11006832,SRR11006834")

elif [[ "$pop" == "Gabon-USA" ]]; then
	pop1="Gabon"
	pop2="USA"
	distinguished1=("SRR11006829" "SRR11006831" "SRR11006828" "SRR11006823" "SRR11006834")
	distinguished2=("SRR6768021" "SRR6768024" "SRR6768014" "SRR6768012" "SRR6768003")
	indivs1=("Gabon:SRR11006820,SRR11006821,SRR11006823,SRR11006824,SRR11006825,SRR11006826,SRR11006827,SRR11006828,SRR11006829,SRR11006830,SRR11006831,SRR11006832,SRR11006834")
	indivs2=("USA:SRR6768001,SRR6768002,SRR6768003,SRR6768004,SRR6768006,SRR6768007,SRR6768008,SRR6768009,SRR6768010,SRR6768011,SRR6768012,SRR6768013,SRR6768014,SRR6768015,SRR6768016,SRR6768017,SRR6768018,SRR6768019,SRR6768020,SRR6768021,SRR6768022,SRR6768023,SRR6768024,SRR6768025,SRR6768026,SRR6768027,SRR6768028")

elif [[ "$pop" == "NorCal-SoCal" ]]; then
	pop1="NorCal"
	pop2="SoCal"
	distinguished1=("SRR6768002" "SRR6768003" "SRR6768004" "SRR6768006" "SRR6768027")
	distinguished2=("SRR6768011" "SRR6768012" "SRR6768014" "SRR6768015" "SRR6768018")
	indivs1=("NorCal:SRR6768001,SRR6768002,SRR6768003,SRR6768004,SRR6768006,SRR6768027")
	indivs2=("SoCal:SRR6768010,SRR6768011,SRR6768012,SRR6768013,SRR6768014,SRR6768015,SRR6768016,SRR6768017,SRR6768018")

elif [[ "$pop" == "NorCal-Florida" ]]; then
	pop1="NorCal"
	pop2="Florida"
	distinguished1=("SRR6768002" "SRR6768003" "SRR6768004" "SRR6768006" "SRR6768027")
	distinguished2=("SRR6768007" "SRR6768008")
	indivs1=("NorCal:SRR6768001,SRR6768002,SRR6768003,SRR6768004,SRR6768006,SRR6768027")
	indivs2=("Florida:SRR6768007,SRR6768008")

elif [[ "$pop" == "NorCal-Exeter" ]]; then
	pop1="NorCal"
	pop2="Exeter"
	distinguished1=("SRR6768002" "SRR6768003" "SRR6768004" "SRR6768006" "SRR6768027")
	distinguished2=("SRR6768009" "SRR6768024")
	indivs1=("NorCal:SRR6768001,SRR6768002,SRR6768003,SRR6768004,SRR6768006,SRR6768027")
	indivs2=("Exeter:SRR6768009,SRR6768024")

elif [[ "$pop" == "NorCal-Clovis" ]]; then
	pop1="NorCal"
	pop2="Clovis"
	distinguished1=("SRR6768002" "SRR6768003" "SRR6768004" "SRR6768006" "SRR6768027")
	distinguished2=("SRR6768020" "SRR6768021" "SRR6768022" "SRR6768023" "SRR6768028")
	indivs1=("NorCal:SRR6768001,SRR6768002,SRR6768003,SRR6768004,SRR6768006,SRR6768027")
	indivs2==("Clovis:SRR6768019,SRR6768020,SRR6768021,SRR6768022,SRR6768023,SRR6768025,SRR6768026,SRR6768028")

elif [[ "$pop" == "SoCal-Florida" ]]; then
	pop1="SoCal"
	pop2="Florida"
	distinguished1=("SRR6768011" "SRR6768012" "SRR6768014" "SRR6768015" "SRR6768018")
	distinguished2=("SRR6768007" "SRR6768008")
	indivs1=("SoCal:SRR6768010,SRR6768011,SRR6768012,SRR6768013,SRR6768014,SRR6768015,SRR6768016,SRR6768017,SRR6768018")
	indivs2=("Florida:SRR6768007,SRR6768008")

elif [[ "$pop" == "SoCal-Exeter" ]]; then
	pop1="SoCal"
	pop2="Exeter"
	distinguished1=("SRR6768011" "SRR6768012" "SRR6768014" "SRR6768015" "SRR6768018")
	distinguished2=("SRR6768009" "SRR6768024")
	indivs1=("SoCal:SRR6768010,SRR6768011,SRR6768012,SRR6768013,SRR6768014,SRR6768015,SRR6768016,SRR6768017,SRR6768018")
	indivs2=("Exeter:SRR6768009,SRR6768024")

elif [[ "$pop" == "SoCal-Clovis" ]]; then
	pop1="SoCal"
	pop2="Clovis"
	distinguished1=("SRR6768011" "SRR6768012" "SRR6768014" "SRR6768015" "SRR6768018")
	distinguished2=("SRR6768020" "SRR6768021" "SRR6768022" "SRR6768023" "SRR6768028")
	indivs1=("SoCal:SRR6768010,SRR6768011,SRR6768012,SRR6768013,SRR6768014,SRR6768015,SRR6768016,SRR6768017,SRR6768018")
	indivs2==("Clovis:SRR6768019,SRR6768020,SRR6768021,SRR6768022,SRR6768023,SRR6768025,SRR6768026,SRR6768028")

elif [[ "$pop" == "Florida-Clovis" ]]; then
	pop1="Florida"
	pop2="Clovis"
	distinguished1=("SRR6768007" "SRR6768008")
	distinguished2=("SRR6768020" "SRR6768021" "SRR6768022" "SRR6768023" "SRR6768028")
	indivs1=("Florida:SRR6768007,SRR6768008")
	indivs2==("Clovis:SRR6768019,SRR6768020,SRR6768021,SRR6768022,SRR6768023,SRR6768025,SRR6768026,SRR6768028")

elif [[ "$pop" == "Florida-Exeter" ]]; then
	pop1="Florida"
	pop2="Exeter"
	distinguished1=("SRR6768007" "SRR6768008")
	distinguished2=("SRR6768009" "SRR6768024")
	indivs1=("Florida:SRR6768007,SRR6768008")
	indivs2=("Exeter:SRR6768009,SRR6768024")

elif [[ "$pop" == "Clovis-Exeter" ]]; then
	pop1="Clovis"
	pop2="Exeter"
	distinguished1=("SRR6768020" "SRR6768021" "SRR6768022" "SRR6768023" "SRR6768028")
	distinguished2=("SRR6768009" "SRR6768024")
	indivs1==("Clovis:SRR6768019,SRR6768020,SRR6768021,SRR6768022,SRR6768023,SRR6768025,SRR6768026,SRR6768028")
	indivs2=("Exeter:SRR6768009,SRR6768024")

else [[ "$pop" == "Senegal-USA" ]]
	pop1="Senegal"
	pop2="USA"
	distinguished1=("SRR11006755" "SRR11006770" "SRR11006763" "SRR11006753" "SRR11006766")
	indivs1=("Senegal:SRR11006749,SRR11006751,SRR11006752,SRR11006753,SRR11006754,SRR11006755,SRR11006756,SRR11006757,SRR11006758,SRR11006759,SRR11006760,SRR11006762,SRR11006763,SRR11006764,SRR11006765,SRR11006766,SRR11006767,SRR11006768,SRR11006769,SRR11006770")
        distinguished2=("SRR6768021" "SRR6768024" "SRR6768014" "SRR6768012" "SRR6768003")
        indivs2=("USA:SRR6768001,SRR6768002,SRR6768003,SRR6768004,SRR6768006,SRR6768007,SRR6768008,SRR6768009,SRR6768010,SRR6768011,SRR6768012,SRR6768013,SRR6768014,SRR6768015,SRR6768016,SRR6768017,SRR6768018,SRR6768019,SRR6768020,SRR6768021,SRR6768022,SRR6768023,SRR6768024,SRR6768025,SRR6768026,SRR6768027,SRR6768028")

fi

#pop=${pop}_100k_sites

module load singularity
mkdir -p ./Data/smc++/${pop}/


#lazily run all 3 chromosomes in same job
singularity exec --bind /work/users/t/v/tvkent/aedes/ ./smc++ smc++ vcf2smc --cores ${SLURM_CPUS_PER_TASK} ./Data/VCFs/AaegL5_full_filtered_snps_110122_rep_map_masked.vcf.gz -d ${distinguished1[distind]} ${distinguished1[distind]} -m ./Data/AaegL5_genes_100000_rep_map_centromere_filtered_sites_mask.bed.gz ./Data/smc++/${pop}/AaegL5_1_${pop1}-${pop2}_${distinguished1[distind]}_5.smc.gz AaegL5_1 ${indivs1} ${indivs2}

singularity exec --bind /work/users/t/v/tvkent/aedes/ ./smc++ smc++ vcf2smc --cores ${SLURM_CPUS_PER_TASK} ./Data/VCFs/AaegL5_full_filtered_snps_110122_rep_map_masked.vcf.gz -d ${distinguished2[distind]} ${distinguished2[distind]} -m ./Data/AaegL5_genes_100000_rep_map_centromere_filtered_sites_mask.bed.gz ./Data/smc++/${pop}/AaegL5_1_${pop2}-${pop1}_${distinguished1[distind]}_5.smc.gz AaegL5_1 ${indivs2} ${indivs1}

singularity exec --bind /work/users/t/v/tvkent/aedes/ ./smc++ smc++ vcf2smc --cores ${SLURM_CPUS_PER_TASK} ./Data/VCFs/AaegL5_full_filtered_snps_110122_rep_map_masked.vcf.gz -d ${distinguished1[distind]} ${distinguished1[distind]} -m ./Data/AaegL5_genes_100000_rep_map_centromere_filtered_sites_mask.bed.gz ./Data/smc++/${pop}/AaegL5_2_${pop1}-${pop2}_${distinguished1[distind]}_5.smc.gz AaegL5_2 ${indivs1} ${indivs2}

singularity exec --bind /work/users/t/v/tvkent/aedes/ ./smc++ smc++ vcf2smc --cores ${SLURM_CPUS_PER_TASK} ./Data/VCFs/AaegL5_full_filtered_snps_110122_rep_map_masked.vcf.gz -d ${distinguished2[distind]} ${distinguished2[distind]} -m ./Data/AaegL5_genes_100000_rep_map_centromere_filtered_sites_mask.bed.gz ./Data/smc++/${pop}/AaegL5_2_${pop2}-${pop1}_${distinguished1[distind]}_5.smc.gz AaegL5_2 ${indivs2} ${indivs1}

singularity exec --bind /work/users/t/v/tvkent/aedes/ ./smc++ smc++ vcf2smc --cores ${SLURM_CPUS_PER_TASK} ./Data/VCFs/AaegL5_full_filtered_snps_110122_rep_map_masked.vcf.gz -d ${distinguished1[distind]} ${distinguished1[distind]} -m ./Data/AaegL5_genes_100000_rep_map_centromere_filtered_sites_mask.bed.gz ./Data/smc++/${pop}/AaegL5_3_${pop1}-${pop2}_${distinguished1[distind]}_5.smc.gz AaegL5_3 ${indivs1} ${indivs2}

singularity exec --bind /work/users/t/v/tvkent/aedes/ ./smc++ smc++ vcf2smc --cores ${SLURM_CPUS_PER_TASK} ./Data/VCFs/AaegL5_full_filtered_snps_110122_rep_map_masked.vcf.gz -d ${distinguished2[distind]} ${distinguished2[distind]} -m ./Data/AaegL5_genes_100000_rep_map_centromere_filtered_sites_mask.bed.gz ./Data/smc++/${pop}/AaegL5_3_${pop2}-${pop1}_${distinguished1[distind]}_5.smc.gz AaegL5_3 ${indivs2} ${indivs1}


mkdir -p ./Results/smc++/${pop}
outdir=./Results/smc++/${pop}

#mkdir -p ./Results/smc++/${pop}_100k_sites_rp5/
#popdir=./Results/smc++/${pop}_100k_sites_rp5/



singularity exec --bind /work/users/t/v/tvkent/aedes/ ./smc++ smc++ split -o ${outdir} ./Results/smc++/${pop1}_100k_sites_rp5/model.final.json ./Results/smc++/${pop2}_100k_sites_rp5/model.final.json ./Data/smc++/${pop}/*smc.gz

singularity exec --bind /work/users/t/v/tvkent/aedes/ ./smc++ smc++ plot ${outdir}/${pop}.pdf ${outdir}/model.final.json
